
bootstrap: docker
From: continuumio/miniconda3

%post

## Allow conda to run.

. /opt/conda/etc/profile.d/conda.sh

## Update conda.

conda update -n base -y -c defaults conda

## Install required software.

conda create -n ZentTools -c conda-forge -c bioconda \
r-devtools r-tidyverse r-data.table \
bioconductor-edger bioconductor-deseq2 bioconductor-rsubread \
fastqc star samtools sra-tools

## Update environment.

conda update -n ZentTools -y -c conda-forge -c bioconda --all

## Clean up extra files.

conda clean -y --all

## Configure sra-toolkit because they went insane.

export PATH=/opt/conda/envs/ZentTools/bin/:$PATH

vdb-config --restore-defaults

## Install ZentTools.

apt-get -y update
apt-get -y install build-essential

R --slave -e "Sys.setenv(TAR='/bin/tar'); devtools::install_github('rpolicastro/ZentTools')"

%environment

export PATH=/opt/conda/envs/ZentTools/bin/:$PATH
